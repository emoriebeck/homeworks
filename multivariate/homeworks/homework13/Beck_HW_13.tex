\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}

% \usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage{array}
\usepackage{longtable}
\usepackage{graphicx}
\usepackage{color}
\usepackage[letterpaper, margin=1in]{geometry}
\usepackage{lscape}
\newcommand{\blandscape}{\begin{landscape}}
\newcommand{\elandscape}{\end{landscape}}
\usepackage{dcolumn}
\usepackage{bbm}
\usepackage{threeparttable}
\usepackage{booktabs}
\usepackage{expex}
\usepackage{pdflscape}
\usepackage{rotating, graphicx}
\usepackage{tabulary}
\usepackage{lscape}
\usepackage{makecell}
\usepackage{algorithm}
\usepackage{multirow}
\usepackage{colortbl}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}

\title{%
Homework 12\\
\large Applied Mutlivariate Analysis}
\date{November 27, 2018}
\author{Emorie Beck}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}
\maketitle
% \SweaveOpts{concordance=TRUE}

\section{Workspace}
\subsection{Packages}



\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{library}\hlstd{(car)}
\hlkwd{library}\hlstd{(knitr)}
\hlkwd{library}\hlstd{(kableExtra)}
\hlkwd{library}\hlstd{(psych)}
\hlkwd{library}\hlstd{(MASS)}
\hlkwd{library}\hlstd{(car)}
\hlkwd{library}\hlstd{(multcomp)}
\hlkwd{library}\hlstd{(Rmisc)}
\hlkwd{library}\hlstd{(mlogit)}
\hlkwd{library}\hlstd{(candisc)}
\hlkwd{library}\hlstd{(broom)}
\hlkwd{library}\hlstd{(plyr)}
\hlkwd{library}\hlstd{(tidyverse)}
\end{alltt}
\end{kframe}
\end{knitrout}



\subsection{data}
The file, Set\_11.csv, contains the data from an experiment investigating the effects of goal- related instructions on performance, persistence, and anxiety. Participants attempted to solve challenging anagrams (words with their letters scrambled, e.g., ULERITO = OUTLIER) during a 30-minute period. Participants could attempt as many anagrams as they wished and could give up and move on to a new one at any time. Persistence was the number of anagrams attempted. Performance was the percentage of anagrams solved correctly, of those attempted. Anxiety was the total score on a questionnaire designed to measure performance-related anxiety, given after the instructions, immediately before starting the task (scores could range from 10 to 40).
Participants were given a set of 10 practice anagrams to give them an idea of their difficulty. Performance on this practice set was 51\%.

Prior to beginning the task, groups were given instructions intended to influence their motivation on the task. Group 1 was told to simply "do your best." Group 2 was told, “most students are able to correctly solve about 60\% of the anagrams you will attempt." Given the practice test experience, these instructions were expected to make the task seem challenging, but not impossible. Group 3 was told, “most students are able to correctly solve 80\% of the anagrams you will attempt." These instructions were expected to make the task seem very difficult.

The researchers posed the following hypotheses:

\begin{enumerate}
\item The increasingly challenging instructions should lead to increasing levels of anxiety.
\item Groups 2 and 3 should exert more persistence than Group 1 but should not differ from each other because there is an upper limit to the number of anagrams that can reasonably be attempted in 30 minutes.
\item Performance should be greatest in Group 2. Group 1 should have lower performance than Group 2 because of lower motivation. Group 3 should have lower performance than Group 2 because of the incapacitating effects of high anxiety.
\end{enumerate}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{wd} \hlkwb{<-} \hlstr{"https://github.com/emoriebeck/homeworks/raw/master/multivariate/homeworks/homework13"}

\hlstd{dat} \hlkwb{<-} \hlkwd{sprintf}\hlstd{(}\hlstr{"%s/Set_11.csv"}\hlstd{, wd)} \hlopt{%>%} \hlkwd{read.csv}\hlstd{(.,} \hlkwc{stringsAsFactors} \hlstd{= F)} \hlopt{%>%} \hlstd{tbl_df} \hlopt{%>%}
  \hlkwd{mutate}\hlstd{(}\hlkwc{Group} \hlstd{=} \hlkwd{factor}\hlstd{(Group))}

\hlkwd{head}\hlstd{(dat)}
\end{alltt}
\begin{verbatim}
## # A tibble: 6 x 5
##   Perform Persist Anxiety Group    ID
##     <int>   <int>   <int> <fct> <int>
## 1      43      19      15 1         1
## 2      40      21      15 1         2
## 3      43      27      11 1         3
## 4      36      19      13 1         4
## 5      25      15      19 1         5
## 6      51      34      10 1         6
\end{verbatim}
\end{kframe}
\end{knitrout}

\section{Question 1}
Analyze each outcome measure separately and comment on the support those analyses provide for the hypotheses. Use any contrasts or follow-up comparisons that you think are important for testing each hypothesis.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{nested1} \hlkwb{<-} \hlstd{dat} \hlopt{%>%}
  \hlkwd{gather}\hlstd{(}\hlkwc{key} \hlstd{= outcome,} \hlkwc{value} \hlstd{= value, Perform}\hlopt{:}\hlstd{Anxiety)} \hlopt{%>%}
  \hlkwd{group_by}\hlstd{(outcome)} \hlopt{%>%}
  \hlkwd{nest}\hlstd{()} \hlopt{%>%}
  \hlkwd{mutate}\hlstd{(}\hlkwc{lm} \hlstd{=} \hlkwd{map}\hlstd{(data,} \hlopt{~}\hlkwd{lm}\hlstd{(value} \hlopt{~} \hlstd{Group,} \hlkwc{data} \hlstd{= . )),}
         \hlkwc{aov} \hlstd{=} \hlkwd{map}\hlstd{(data,} \hlopt{~}\hlkwd{aov}\hlstd{(value} \hlopt{~} \hlstd{Group,} \hlkwc{data} \hlstd{= .)),}
         \hlkwc{tidy.lm} \hlstd{=} \hlkwd{map}\hlstd{(lm, broom}\hlopt{::}\hlstd{tidy),}
         \hlkwc{tidy.aov} \hlstd{=} \hlkwd{map}\hlstd{(aov, broom}\hlopt{::}\hlstd{tidy))}

\hlstd{nested1} \hlopt{%>%}
  \hlkwd{unnest}\hlstd{(tidy.lm)} \hlopt{%>%}
  \hlkwd{filter}\hlstd{(}\hlkwd{grepl}\hlstd{(}\hlstr{"Group"}\hlstd{, term))} \hlopt{%>%}
  \hlkwd{mutate}\hlstd{(}\hlkwc{p.value} \hlstd{=} \hlkwd{ifelse}\hlstd{(p.value} \hlopt{<} \hlnum{.001}\hlstd{,} \hlstr{"<.001"}\hlstd{,} \hlkwd{ifelse}\hlstd{(p.value} \hlopt{<} \hlnum{.01}\hlstd{,}
                      \hlstr{"<.01"}\hlstd{,} \hlkwd{ifelse}\hlstd{(p.value} \hlopt{<} \hlnum{.05}\hlstd{,} \hlstr{"<.05"}\hlstd{,} \hlstr{">.05"}\hlstd{))))} \hlopt{%>%}
  \hlkwd{kable}\hlstd{(.,} \hlstr{"latex"}\hlstd{,} \hlkwc{booktabs} \hlstd{= T,} \hlkwc{escape} \hlstd{= F,} \hlkwc{digits} \hlstd{=} \hlnum{2}\hlstd{)} \hlopt{%>%}
  \hlkwd{kable_styling}\hlstd{(}\hlkwc{full_width} \hlstd{= F)}
\end{alltt}
\end{kframe}\begin{table}[H]
\centering
\begin{tabular}{llrrrl}
\toprule
outcome & term & estimate & std.error & statistic & p.value\\
\midrule
Perform & Group2 & 13.75 & 4.25 & 3.23 & <.01\\
Perform & Group3 & 3.35 & 4.17 & 0.80 & >.05\\
Persist & Group2 & 17.15 & 2.78 & 6.16 & <.001\\
Persist & Group3 & 15.74 & 2.73 & 5.77 & <.001\\
Anxiety & Group2 & 4.29 & 1.68 & 2.56 & <.05\\
\addlinespace
Anxiety & Group3 & 8.50 & 1.64 & 5.18 & <.001\\
\bottomrule
\end{tabular}
\end{table}

\begin{kframe}\begin{alltt}
\hlstd{H1.1} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{1}\hlstd{,} \hlnum{0}\hlstd{)} \hlcom{# -1*G1 + 0*G2 + 1*G3 = 0}
\hlcom{# -1*(I) + 0*(I + D1) + 1*(I + D2) = 0}
\hlcom{# -I + I + D2 = 0}
\hlcom{# D2 = 0}
\hlstd{H2.1} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{1}\hlstd{,} \hlnum{1}\hlstd{)} \hlcom{# G1 = G2 + G3}
\hlcom{# (I) = (I + D1 + I + D2)}
\hlcom{# 0 = I + D1 + D2}
\hlstd{H3.1} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlopt{-}\hlnum{1}\hlstd{,} \hlnum{0}\hlstd{)} \hlcom{# G1 + G3 = G2}
\hlcom{# I + I + D2 = I + D1}
\hlcom{# I - D1 + D2 = 0}
\hlstd{H.1} \hlkwb{<-} \hlkwd{rbind}\hlstd{(H1.1, H2.1, H3.1)}
\hlkwd{rownames}\hlstd{(H.1)} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"H1"}\hlstd{,} \hlstr{"H2"}\hlstd{,} \hlstr{"H3"}\hlstd{)}

\hlstd{tab_fun} \hlkwb{<-} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
  \hlstd{x}\hlopt{$}\hlstd{confint} \hlopt{%>%} \hlstd{data.frame} \hlopt{%>%}
    \hlkwd{mutate}\hlstd{(}\hlkwc{Group} \hlstd{=} \hlkwd{rownames}\hlstd{(x}\hlopt{$}\hlstd{confint))} \hlopt{%>%}
    \hlkwd{select}\hlstd{(Group,} \hlkwd{everything}\hlstd{())}
\hlstd{\}}

\hlstd{nested1} \hlkwb{<-} \hlstd{nested1} \hlopt{%>%}
  \hlkwd{mutate}\hlstd{(}\hlkwc{comp} \hlstd{=} \hlkwd{map}\hlstd{(lm,} \hlopt{~}\hlkwd{glht}\hlstd{(.,} \hlkwc{linfct}\hlstd{=H.1,} \hlkwc{alternative}\hlstd{=}\hlstr{"two.sided"}\hlstd{,}\hlkwc{rhs}\hlstd{=}\hlnum{0}\hlstd{)),}
         \hlkwc{summ} \hlstd{=} \hlkwd{map}\hlstd{(comp,} \hlopt{~}\hlkwd{confint}\hlstd{(.,} \hlkwd{adjusted}\hlstd{(}\hlstr{"holm"}\hlstd{),} \hlkwc{calpha} \hlstd{=} \hlkwd{univariate_calpha}\hlstd{())),}
         \hlkwc{tab} \hlstd{=} \hlkwd{map}\hlstd{(summ, tab_fun))}

\hlstd{nested1} \hlopt{%>%} \hlkwd{unnest}\hlstd{(tab)} \hlopt{%>%}
  \hlkwd{filter}\hlstd{((outcome} \hlopt{==} \hlstr{"Anxiety"} \hlopt{&} \hlstd{Group} \hlopt{==} \hlstr{"H1"}\hlstd{)} \hlopt{|}
         \hlstd{(outcome} \hlopt{==} \hlstr{"Persist"} \hlopt{&} \hlstd{Group} \hlopt{==} \hlstr{"H2"}\hlstd{))}
\end{alltt}
\begin{verbatim}
## # A tibble: 2 x 5
##   outcome Group Estimate    lwr   upr
##   <chr>   <chr>    <dbl>  <dbl> <dbl>
## 1 Persist H2       60.5  53.8   67.3 
## 2 Anxiety H1        4.29  0.946  7.63
\end{verbatim}
\end{kframe}
\end{knitrout}


\section{Question 2}
Then conduct a multivariate analysis and indicate if this approach adds any additional insight or qualification to the univariate analyses.
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{dat}\hlopt{$}\hlstd{Group.sum} \hlkwb{<-} \hlstd{dat}\hlopt{$}\hlstd{Group}
\hlkwd{contrasts}\hlstd{(dat}\hlopt{$}\hlstd{Group.sum)} \hlkwb{<-} \hlkwd{contr.Sum}\hlstd{(}\hlnum{3}\hlstd{)}
\hlstd{m1} \hlkwb{<-} \hlkwd{manova}\hlstd{(}\hlkwd{cbind}\hlstd{(Perform, Persist, Anxiety)} \hlopt{~} \hlstd{Group.sum,} \hlkwc{data} \hlstd{= dat)}

\hlkwd{summary}\hlstd{(m1)}\hlopt{$}\hlstd{SS}
\end{alltt}
\begin{verbatim}
## $Group.sum
##          Perform  Persist   Anxiety
## Perform 2508.431 2464.959  353.3990
## Persist 2464.959 4518.314 1699.2928
## Anxiety  353.399 1699.293  921.8728
## 
## $Residuals
##           Perform   Persist   Anxiety
## Perform 15958.289  8341.921 -4003.599
## Persist  8341.921  6837.872 -2815.093
## Anxiety -4003.599 -2815.093  2476.127
\end{verbatim}
\begin{alltt}
\hlstd{m1}\hlopt{$}\hlstd{coefficients}
\end{alltt}
\begin{verbatim}
##                  Perform    Persist     Anxiety
## (Intercept)    55.618632  38.605427 16.14376068
## Group.sum[S.1] -5.698632 -10.965427 -4.26376068
## Group.sum[S.2]  8.048034   6.186239  0.02290598
\end{verbatim}
\begin{alltt}
\hlstd{dat} \hlkwb{<-} \hlstd{dat} \hlopt{%>%}
  \hlkwd{mutate}\hlstd{(}\hlkwc{H1} \hlstd{=} \hlkwd{as.numeric}\hlstd{(}\hlkwd{as.character}\hlstd{(}\hlkwd{mapvalues}\hlstd{(Group,} \hlnum{1}\hlopt{:}\hlnum{3}\hlstd{,} \hlkwd{c}\hlstd{(}\hlopt{-}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{)))),}
         \hlkwc{H2} \hlstd{=} \hlkwd{as.numeric}\hlstd{(}\hlkwd{as.character}\hlstd{(}\hlkwd{mapvalues}\hlstd{(Group,} \hlnum{1}\hlopt{:}\hlnum{3}\hlstd{,} \hlkwd{c}\hlstd{(}\hlnum{2}\hlstd{,}\hlopt{-}\hlnum{1}\hlstd{,}\hlopt{-}\hlnum{1}\hlstd{)))),}
         \hlkwc{H3.1} \hlstd{=} \hlkwd{as.numeric}\hlstd{(}\hlkwd{as.character}\hlstd{(}\hlkwd{mapvalues}\hlstd{(Group,} \hlnum{1}\hlopt{:}\hlnum{3}\hlstd{,} \hlkwd{c}\hlstd{(}\hlopt{-}\hlnum{1}\hlstd{,} \hlnum{1}\hlstd{,} \hlnum{0}\hlstd{)))),}
         \hlkwc{H3.2} \hlstd{=} \hlkwd{as.numeric}\hlstd{(}\hlkwd{as.character}\hlstd{(}\hlkwd{mapvalues}\hlstd{(Group,} \hlnum{1}\hlopt{:}\hlnum{3}\hlstd{,} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{1}\hlstd{,} \hlopt{-}\hlnum{1}\hlstd{)))))}

\hlstd{H1.2lm} \hlkwb{<-} \hlkwd{lm}\hlstd{(}\hlkwd{cbind}\hlstd{(Perform, Persist, Anxiety)} \hlopt{~} \hlstd{H1,} \hlkwc{data} \hlstd{= dat)}
\hlstd{H1.2} \hlkwb{<-} \hlkwd{candisc}\hlstd{(H1.2lm,} \hlkwc{term}\hlstd{=}\hlstr{"H1"}\hlstd{,} \hlkwc{data} \hlstd{= dat ,}\hlkwc{type}\hlstd{=}\hlstr{"2"}\hlstd{)}
\hlstd{H1.2}\hlopt{$}\hlstd{coeffs.raw}
\end{alltt}
\begin{verbatim}
##                Can1
## Perform -0.01170095
## Persist  0.14282440
## Anxiety  0.18415089
\end{verbatim}
\begin{alltt}
\hlstd{H2.2lm} \hlkwb{<-} \hlkwd{lm}\hlstd{(}\hlkwd{cbind}\hlstd{(Perform, Persist, Anxiety)} \hlopt{~} \hlstd{H2,} \hlkwc{data} \hlstd{= dat)}
\hlstd{H2.2} \hlkwb{<-} \hlkwd{candisc}\hlstd{(H2.2lm,} \hlkwc{term}\hlstd{=}\hlstr{"H2"}\hlstd{,} \hlkwc{data} \hlstd{= dat ,}\hlkwc{type}\hlstd{=}\hlstr{"2"}\hlstd{)}
\hlstd{H2.2}\hlopt{$}\hlstd{coeffs.raw}
\end{alltt}
\begin{verbatim}
##                Can1
## Perform -0.01170095
## Persist  0.14282440
## Anxiety  0.18415089
\end{verbatim}
\begin{alltt}
\hlstd{H3.2lm} \hlkwb{<-} \hlkwd{lm}\hlstd{(}\hlkwd{cbind}\hlstd{(Perform, Persist, Anxiety)} \hlopt{~} \hlstd{H3.1} \hlopt{+} \hlstd{H3.2,} \hlkwc{data} \hlstd{= dat)}
\hlstd{H3.2} \hlkwb{<-} \hlkwd{candisc}\hlstd{(H3.2lm,} \hlkwc{term}\hlstd{=}\hlstr{"H3.2"}\hlstd{,} \hlkwc{data} \hlstd{= dat ,}\hlkwc{type}\hlstd{=}\hlstr{"2"}\hlstd{)}
\hlstd{H3.2}\hlopt{$}\hlstd{coeffs.raw}
\end{alltt}
\begin{verbatim}
##                Can1
## Perform -0.04318753
## Persist  0.15979975
## Anxiety  0.18633789
\end{verbatim}
\end{kframe}
\end{knitrout}

\end{document}
